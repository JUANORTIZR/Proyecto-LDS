•
9F:\Documento\GitHub\Proyecto-LDS\Infraestructura\Email.cs
	namespace 	
Infraestructura
 
{ 
public 

class 
Email 
{ 
private 
MailMessage 
email !
;! "
private 

SmtpClient 
smtp 
;  
public 
Email 
( 
) 
{ 
smtp		 
=		 
new		 

SmtpClient		 !
(		" #
)		# $
;		$ %
}

 	
private 
void 
ConfigurarSmt "
(# $
)$ %
{& '
smtp 
. 
Host 
= 
$str (
;( )
smtp 
. 
Port 
= 
$num 
; 
smtp 
. 
	EnableSsl 
= 
true !
;! "
smtp 
. !
UseDefaultCredentials &
=' (
false) .
;. /
smtp 
. 
Credentials 
= 
new "
System# )
.) *
Net* -
.- .
NetworkCredential. ?
(@ A
$strA W
,W X
$strY d
)d e
;e f
} 	
private 
void 
ConfigurarEmail $
(% &
string& ,
correoElectronico- >
,> ?
string? E
cuerpoEmailF Q
,Q R
stringR X

encabezadoY c
)c d
{e f
email 
= 
new 
MailMessage #
($ %
)% &
;& '
email 
. 
To 
. 
Add 
( 
correoElectronico +
)+ ,
;, -
email 
. 
From 
= 
new 
MailAddress (
() *
$str* @
)@ A
;A B
email 
. 
Subject 
= 

encabezado &
;& '
email 
. 
Body 
= 
cuerpoEmail $
;$ %
email 
. 

IsBodyHtml 
= 
true #
;# $
email 
. 
Priority 
= 
MailPriority )
.) *
Normal* 0
;0 1
} 	
public 
string 
EnviarEmail !
(" #
string# )
correoElectronico* ;
,; <
string< B
cuerpoEmailC N
,N O
stringP V

encabezadoW a
)a b
{c d
try 
{ 
ConfigurarSmt 
( 
)  
;  !
ConfigurarEmail 
(  !
correoElectronico! 2
,2 3
cuerpoEmail4 ?
,? @

encabezadoA K
)K L
;L M
smtp   
.   
Send   
(   
email    
)    !
;  ! "
return!! 
(!! 
$str!! :
)!!: ;
;!!; <
}"" 
catch"" 
("" 
	Exception"" 
e""  
)""  !
{""" #
return## 
(## 
$str## 0
+##1 2
e##3 4
.##4 5
Message##5 <
)##< =
;##= >
}$$ 
finally$$ 
{$$ 
email%% 
.%% 
Dispose%% 
(%% 
)%%  
;%%  !
}&& 
}'' 	
}(( 
})) 